apply plugin: 'com.android.library'
apply plugin: "org.jetbrains.kotlin.android"
apply plugin: "com.facebook.react"

group = 'expo.modules.thermalibexpo'
version = '0.1.0'

def expoModulesCorePlugin = new File(project(":expo-modules-core").projectDir.absolutePath, "ExpoModulesCorePlugin.gradle")
apply from: expoModulesCorePlugin
applyKotlinExpoModulesCorePlugin()
useCoreDependencies()
useDefaultAndroidSdkVersions()
useExpoPublishing()

buildscript {
    ext {
        buildToolsVersion = "35.0.0"
        minSdkVersion = 24
        compileSdkVersion = 35
        targetSdkVersion = 34
        ndkVersion = "26.1.10909125"
        kotlinVersion = "1.9.24"
    }
    repositories {
        google()
        mavenCentral()
    }
    dependencies {
        classpath("com.android.tools.build:gradle")
        classpath("com.facebook.react:react-native-gradle-plugin")
        classpath("org.jetbrains.kotlin:kotlin-gradle-plugin")
    }
}

// If you want to use the managed Android SDK versions from expo-modules-core, set this to true.
// The Android SDK versions will be bumped from time to time in SDK releases and may introduce breaking changes in your module code.
// Most of the time, you may like to manage the Android SDK versions yourself.
 def useManagedAndroidSdkVersions = true
 if (useManagedAndroidSdkVersions) {
   useDefaultAndroidSdkVersions()
 } else {
   buildscript {
     // Simple helper that allows the root project to override versions declared by this library.
     ext.safeExtGet = { prop, fallback ->
       rootProject.ext.has(prop) ? rootProject.ext.get(prop) : fallback
     }
   }
   project.android {
     compileSdkVersion safeExtGet("compileSdkVersion", 34)
     defaultConfig {
       minSdkVersion safeExtGet("minSdkVersion", 21)
       targetSdkVersion safeExtGet("targetSdkVersion", 34)
     }}
}

android {
  compileSdkVersion 35
  namespace "expo.modules.thermalibexpo"

  defaultConfig {
    versionCode 1
    versionName "0.1.0"
    minSdkVersion 21
    targetSdkVersion 35
  }

  lintOptions {
    abortOnError false
  }

  repositories {
    mavenCentral()
    google()
  }

  dependencies{
    // For < 0.71, this will be from the local maven repo
    // For > 0.71, this will be replaced by `com.facebook.react:react-android:$version` by react gradle plugin
    //noinspection GradleDynamicVersion
    // "com.facebook.react:react-native:+"
    implementation("com.facebook.react:react-android")
    // Added in withLocalBroadcastManager.ts
    // implementation 'com.android.support:localbroadcastmanager:28.0.0'
    implementation project(":${project.name}\$thermalib-aar")
    implementation 'androidx.appcompat:appcompat:1.1.0'
    implementation 'androidx.core:core-ktx:1.6.0'
    
    // configurations.all {
    //     resolutionStrategy {
    //         force("com.android.support:localbroadcastmanager:28.0.0")
    //     }
    // }
  }
}
