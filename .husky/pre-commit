#!/usr/bin/env bash
set -euo pipefail

echo "ğŸ¤“ Husky: starting pre-commit quality gate (thermalib-expo)"

if git diff --cached --quiet; then
	echo "â„¹ï¸  No staged changes detected; skipping checks"
	exit 0
fi

echo "ğŸ§ª Running tests..."
if npm run test:dev >/dev/null 2>&1; then
	echo "âœ… Tests passed"
else
	echo "âŒ Tests failed"
	exit 1
fi

echo "ğŸ§¹ Lint + format..."
if npm run lint >/dev/null 2>&1; then
	echo "âœ… Lint clean"
else
	echo "âŒ Lint errors"
	exit 1
fi

echo "ğŸ” Type check (tsc)..."
if npm run ts >/dev/null 2>&1; then
	echo "âœ… Typecheck passed"
else
	echo "âŒ Type errors"
	exit 1
fi

echo "ğŸš€ Pre-commit passed for thermalib-expo"